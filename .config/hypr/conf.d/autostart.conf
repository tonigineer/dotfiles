# ============================================================
# Hyprland Autostart — Secrets, Polkit, Shell Loader, RGB
#
# Hyprland exec/exec-once reference:
#   https://wiki.hyprland.org/Configuring/Keywords/#exec-and-exec-once
# Quickshell (qs):
#   https://github.com/Quickshell/Quickshell
# ============================================================


# ------------------------------------------------------------
# Optional: Hyprland-managed helpers (disabled)
# (noctalia-shell currently manages wallpaper/idling)
# ------------------------------------------------------------
# exec-once = hyprpaper
# exec-once = hypridle

exec-once = gnome-keyring-daemon --restart --components=secrets || $NOTIFY_ERROR "gnome-keyring-daemon could not be started."
exec-once = systemctl --user restart hyprpolkitagent || $NOTIFY_ERROR "hyprpolkitagent could not be started."


# ------------------------------------------------------------
# Quickshell — NOCTALIA session
# HYPRLANG conditional enables this only when HYPR_NOCTALIA is defined.
# ------------------------------------------------------------

# hyprlang if HYPR_NOCTALIA

exec-once = killall -9 qs; killall -9 quickshell; QS_NO_RELOAD_POPUP=1 QML_DISABLE_DISK_CACHE=1 qs -c noctalia-shell
exec-once = [[ -e "~/.config/noctalia/settings.json" ]] || ln -s "$HOME/.config/noctalia/$(cat /etc/hostname)-settings.json" ~/.config/noctalia/settings.json

# hyprlang endif


# ------------------------------------------------------------
# Quickshell — CAELESTIA session
# HYPRLANG conditional enables this only when HYPR_CAELESTIA is defined.
# ------------------------------------------------------------

# hyprlang if HYPR_CAELESTIA

exec-once = killall -9 qs; killall -9 quickshell; QS_NO_RELOAD_POPUP=1 QML_DISABLE_DISK_CACHE=1 qs -c caelestia
exec-once = [[ -e "~/.config/caelestia/shell.json" ]] || ln -s "$HOME/.config/caelestia/$(cat /etc/hostname)-shell.json" ~/.config/caelestia/shell.json

# hyprlang endif


# ------------------------------------------------------------
# OpenRGB — Set Leviathan V2 X LEDs to black
# ------------------------------------------------------------

exec = openrgb -d "$(openrgb -l | awk -F': ' '/Razer Leviathan V2 X/{print $1; exit}')" -c 000000


# ------------------------------------------------------------
# Hyprland
# ------------------------------------------------------------

# Focus right monitor on a two monitor setting with the
# right one being the primary monitor.
exec-once = hyprctl dispatch workspace 1

exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
